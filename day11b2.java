package com.shpp.p2p.cs.siskov.adventofcode;

import java.util.ArrayList;

/**
 * This task "Day 11: Cosmic Expansion " is from https://adventofcode.com/2023/day/11
 * We need to calculate sum of lengths of the shortest path between every pair of galaxies.
 * Created by Sergii Iskov, 2023. Version 1.0
 */
public class day11b2 {
    public static void main(String[] args) {
        String[] dataArr = data.split("\n");
        boolean[] isStarInRow = new boolean[dataArr.length];
        for (int i = 0; i < dataArr.length; i++) {
            if (dataArr[i].contains("#")) {
                isStarInRow[i] = true;
            }
        }
        boolean[] isStarInCol = new boolean[dataArr[0].length()];
        for (int i = 0; i < dataArr[0].length(); i++) {
            for (int j = 0; j < dataArr.length; j++) {
                if (dataArr[j].charAt(i) == '#') {
                    isStarInCol[i] = true;
                    break;
                }
            }
        }

        ArrayList<int[]> starCol = createStarCollection(dataArr);

        long ranges1 = findRange(starCol, isStarInRow, isStarInCol, 2);
        System.out.println("Expanding the universe = 2, sum of ranges = " + ranges1);
        long ranges2 = findRange(starCol, isStarInRow, isStarInCol, 1000000);
        System.out.println("Expanding the universe = 100000, sum of ranges = " + ranges2);
    }

    private static ArrayList<int[]> createStarCollection(String[] array) {
        ArrayList<int[]> starCol = new ArrayList<>();
        for (int i = 0; i < array.length; i++) {
            for (int j = 0; j < array[i].length(); j++) {
                if (array[i].charAt(j) == '#') {
                    starCol.add(new int[]{i, j});
                }
            }
        }
        return starCol;
    }

    private static long findRange(ArrayList<int[]> starCol, boolean[] startColumn, boolean[] startRow, int MK) {
        long range = 0;
        for (int i = 0; i < starCol.size() - 1; i++) {
            for (int j = i + 1; j < starCol.size(); j++) {
                long multX = 0, multY = 0;
                int firstStarX = starCol.get(i)[1], secondStarX = starCol.get(j)[1];
                if (firstStarX > secondStarX) {
                    firstStarX = secondStarX;
                    secondStarX = starCol.get(i)[1];
                }
                for (int k = firstStarX; k < secondStarX; k++) {
                    if (!startRow[k]) multX += 1;
                }
                int firstStarY = starCol.get(i)[0], secondStarY = starCol.get(j)[0];
                if (firstStarY > secondStarY) {
                    firstStarY = secondStarY;
                    secondStarY = starCol.get(i)[1];
                }
                for (int k = firstStarY; k < secondStarY; k++) {
                    if (!startColumn[k]) multY += 1;
                }
                long distance = (secondStarY - firstStarY) + (secondStarX - firstStarX)
                        + (multX + multY) * (MK - 1);
                range += distance;
            }
        }
        return range; // 401709500566 // 401707303950 // 401707350781 // 603246299029
        //Expanding the universe = 2, sum of ranges = 9550717
        //Expanding the universe = 100, sum of ranges = 73098817
        //Expanding the universe = 1000000, sum of ranges = 648458253817

    }

    private static String data1 = "...#......\n" +
            ".......#..\n" +
            "#.........\n" +
            "..........\n" +
            "......#...\n" +
            ".#........\n" +
            ".........#\n" +
            "..........\n" +
            ".......#..\n" +
            "#...#.....";
    private static String data2 =
            "..#..........#................................................#.............................................................................\n" +
                    "...................................#............................................#..........................#............................#...\n" +
                    "............................................................................................................................................\n" +
                    "........#...................................#..................................................................................#............\n" +
                    ".................#.........#..........#...............#........................................#.................#..........................\n" +
                    ".................................#..............#...................................#.......................................................\n" +
                    "#.........................................................................#...............#............................#....................\n" +
                    ".......................#........................................................#...........................................................\n";


    private static String data = "..#..........#................................................#.............................................................................\n" +
            "...................................#............................................#..........................#............................#...\n" +
            "......................................................................#.............................#.......................................\n" +
            "........#...................................#..................................................................................#............\n" +
            ".................#.........#..........#...............#........................................#.................#..........................\n" +
            ".................................#..............#...................................#.......................................................\n" +
            "#.........................................................................#...............#............................#....................\n" +
            ".......................#........................................................#...........................................................\n" +
            ".......#.........................................................#................................#.................................#.......\n" +
            "..................#...............................#...........................................................#.............................\n" +
            "...........#.................................#..............#................................................................#...........#..\n" +
            "..........................#........#........................................................................................................\n" +
            ".#..................................................................#................#.................#....................................\n" +
            "......................#.........................#.....................................................................................#.....\n" +
            "..........................................#....................#..............#....................#........................................\n" +
            ".........................................................................................#.........................#.....#..................\n" +
            "..............#.............................................................................................................................\n" +
            "..........................................................................................................#........................#........\n" +
            ".....#.........................#.............#....................#.......#........#........................................#...............\n" +
            "..........................#...........#...............................................................#.....................................\n" +
            "...................#...........................................................................#................#...........................\n" +
            "#............#........................................#................................................................................#....\n" +
            "......................................................................................................................#.........#...........\n" +
            "........................................#...................................................................................................\n" +
            "...#............#........#...........................................................#......................................................\n" +
            ".............................................#..............................................................................................\n" +
            "............#.......#..........................................................................#..................#.....#...................\n" +
            "................................................................................#.........................#....................#.....#......\n" +
            ".................................................................#..........................................................................\n" +
            "..........................#...............#.................................................#.................#.............................\n" +
            "#.........#...........................................#............................................#........................................\n" +
            ".....................#................#................................#....................................................................\n" +
            ".....................................................................................#.....................#............#...................\n" +
            "............................................................................................................................................\n" +
            ".............................#..........................................................................................................#...\n" +
            ".................#..................#......#......#............................#......................#..........#...........#..............\n" +
            ".......#.................#...........................................#......................................................................\n" +
            "......................................................................................#.....................................................\n" +
            "...#....................................................#......#..................................#.........................................\n" +
            "............#........#.........#..............#.........................#....................................#..............................\n" +
            ".......................................................................................................#................#.....#.............\n" +
            "..............................................................................................#.............................................\n" +
            "....................................................................................#..............................#......................#.\n" +
            "#.............#.........#..................#.............................................#...........................................#......\n" +
            ".............................#......#...........#.........#...................#.............................................................\n" +
            ".......#...........................................................................................#.....#..................................\n" +
            "...................#........................................................................................................#.....#.........\n" +
            "....................................................#..................#....................................................................\n" +
            ".................................#............................#.............................................................................\n" +
            ".......................#.................................#...........................................................................#......\n" +
            "........................................#..........................................#............#...............#...........................\n" +
            ".........................................................................................#..................................................\n" +
            ".............................................#......................#.......................................................................\n" +
            "..........................#...........................................................................#.........................#...........\n" +
            "............................................................................................................................................\n" +
            "...........#....................................................................#......#....................................................\n" +
            "....................................................................................................................#......................#\n" +
            "...............#........................#....................................................#..............................................\n" +
            ".....#.........................................#................#...........................................................................\n" +
            ".......................#.............................................#................................#..................#.........#........\n" +
            "#.........#.........................................#..........................#........#.......................#...........................\n" +
            "..............................#.............................................................................................................\n" +
            ".....................................#....................................................................#.....................#...........\n" +
            "..............................................................#.............#...............................................................\n" +
            "..#......................................................................................................................................#..\n" +
            ".................#.........#........................................................#....................................#..................\n" +
            "................................#.......................#.......................................#...........................................\n" +
            "..........................................#.....#...................................................................#.......................\n" +
            "......#......#.........................................................................................#......................#.............\n" +
            "......................................#..............#......................................................................................\n" +
            "..................#...........#.................................#...........................................................................\n" +
            "..#.......#............................................................................#...................................................#\n" +
            "......................#..................................#..............#...................................................................\n" +
            "..........................................................................................................................#.................\n" +
            ".................................#.........#....................................................#...........................................\n" +
            "............................................................................................................................................\n" +
            "....................#...............................................................................#.......................................\n" +
            ".#...................................#..........#...........................................................................................\n" +
            ".......#..............................................................#.................................#...................................\n" +
            ".............................#...........#.....................#.................................#.............................#............\n" +
            ".......................#....................................................................#...................#......................#....\n" +
            ".............#.....................#.................#..........................#....................................#......................\n" +
            "...........................................................................#............#...........#..............................#........\n" +
            "..........................................................................................................................................#.\n" +
            ".#..............................#...........................................................................................................\n" +
            ".............................................#............#...............................................#.................................\n" +
            "...............#.......#..........................#.................#.......................#...........................#...................\n" +
            "...............................................................................#.................................................#..........\n" +
            ".........#..............................#..............................................................#......#.............................\n" +
            "............................................................................................................................................\n" +
            "................................................#........................................#..................................................\n" +
            ".........................................................................#......................#.....................................#.....\n" +
            "...........#......#..........#......................#......................................................................#................\n" +
            "..........................................................#...................#.....#.......#.....................#.........................\n" +
            "......................................#.....................................................................................................\n" +
            "........#................................................................................................................................#..\n" +
            "......................#........................#................#....................................#........#.............................\n" +
            "..#.......................................#.......................................................................................#.........\n" +
            "..............#.............................................................................................................................\n" +
            ".........................................................................#..................................................................\n" +
            ".........................#..........#........#........................................#.....................................................\n" +
            ".....#..................................................#..................................................................................#\n" +
            "..............................#................................#..............#..............#................#............#................\n" +
            "........................................................................................................#.............#.........#...........\n" +
            ".#.............#.......................................................#....................................................................\n" +
            ".......................................#....................................................................................................\n" +
            ".......................#..........................#.......#.................................................................................\n" +
            ".......#........................................................................#...........................................................\n" +
            "............................#........................................#................................................................#.....\n" +
            "..........................................#..........#........................................................#.............................\n" +
            "..............#..........................................................................#.....#..................................#.........\n" +
            "#...........................................................................................................................................\n" +
            "..................................#................................................................#........................#...............\n" +
            "..................................................................#.........................#...............#..........................#....\n" +
            ".......................................#...................................#..........#............................#........................\n" +
            "..................#.....#.....#.............#..........................................................#....................................\n" +
            "...................................................................................................................................#........\n" +
            "......................................................#.......................................................#.............................\n" +
            "...........#...............#...................#...............#....................#...............#.................#.....................\n" +
            ".........................................#......................................................................................#...........\n" +
            "...............................#.........................................................#......#.................#.....................#...\n" +
            "..#.................................................#....................................................#...............#..................\n" +
            "........#.............................#.....................................................................................................\n" +
            "..............#.........#................................................#..................................................................\n" +
            "..........................................#.....................................#....................#.......................#..............\n" +
            "............................................................................................................................................\n" +
            "................................#...............#..........................................................#.....#...............#..........\n" +
            "..#.......#.................................................................................................................................\n" +
            "........................................................................#...............................................#...................\n" +
            "............................#.................................#.........................#..........#........................................\n" +
            "....................#.............................#.........................................................................#...............\n" +
            "........................................................#....................................#..........#......#............................\n" +
            "........#...................................................................................................................................\n" +
            ".........................................................................#..........#.......................................................\n" +
            "............#......................#............#.................................................................#.....................#...\n" +
            ".............................#.....................................................................#........................................\n" +
            "........................................................................................................................#...................\n" +
            ".......#.........#...........................................................................#.........#......#.............................\n" +
            "........................#.............................#..........#...................................................................#......\n" +
            "...#.................................#........#................................#.....#.......................................#..............";
}

